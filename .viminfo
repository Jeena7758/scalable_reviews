# This viminfo file was generated by Vim 9.1.
# You may edit it if you're careful!

# Viminfo version
|1,4

# Value of 'encoding' when this file was written
*encoding=utf-8


# hlsearch on (H) or off (h):
~h
# Last Search Pattern:
~MSle0~/duration_sec

# Command Line History (newest to oldest):
:q
|2,0,1751039508,,"q"
:wq!
|2,0,1751039487,,"wq!"
:q!
|2,0,1750972496,,"q!"

# Search String History (newest to oldest):
?/duration_sec
|2,1,1750976843,47,"duration_sec"
?/time.time() - 
|2,1,1750974590,47,"time.time() - "
?/total_reviews
|2,1,1750972148,47,"total_reviews"
?/metric
|2,1,1750972105,47,"metric"
?/BATCH_THREAD_SIZE
|2,1,1750971773,47,"BATCH_THREAD_SIZE"
?/raw_batch
|2,1,1750971736,47,"raw_batch"
?/executor
|2,1,1750971673,47,"executor"
?/features
|2,1,1750971662,47,"features"
?/poll
|2,1,1750971621,47,"poll"
?/THREAD
|2,1,1750971479,47,"THREAD"
?/clear
|2,1,1750968705,47,"clear"

# Expression History (newest to oldest):

# Input Line History (newest to oldest):

# Debug Line History (newest to oldest):

# Registers:
""1	LINE	0
	import boto3
	import json
	import re
	from multiprocessing import Pool, cpu_count
	from collections import Counter
	
	# S3 CONFIG
	S3_BUCKET = 'imdbreviews-scalable'
	S3_KEY = 'input_files/sample.json'  # Replace with correct path if needed
	
	# S3 Client
	s3 = boto3.client('s3')
	
	# Stopwords or meaningless tags
	INVALID_HASHTAGS = {f"#{i}" for i in range(1, 21)} | {'#t', '#a'}
	
	def read_reviews_from_s3():
	    response = s3.get_object(Bucket=S3_BUCKET, Key=S3_KEY)
	    content = response['Body'].read().decode('utf-8')
	    return json.loads(content)
	
	# Define stop tags set globally
	stop_tags = {
	    'the', 'and', 'you', 'but', 'was', 'are', 'for', 'have', 'not',
	    'his', 'her', 'she', 'there', 'with', 'this', 'that', 'what',
	    'in', 'on', 'out', 'at', 'by', 'all', 'spoiler', 'movie', 'film',
	    'one', 'more', 'some', 'just', 'from', 'like', 'contains', 'commentessentially'
	}
	
	def extract_hashtags(review):
	    text = review.get("review_detail", "") + " " + review.get("review_summary", "")
	
	    # Find hashtags that are standalone and alphabetic, at least 4 characters
	    raw_tags = re.findall(r'(?<!\w)#([a-zA-Z]{4,})\b', text)
	
	    filtered = [
	        f"#{tag.lower()}" for tag in raw_tags
	        if tag.lower() not in stop_tags
	    ]
	    return filtered
	
	def flatten(list_of_lists):
	    return [item for sublist in list_of_lists for item in sublist]
	
	if __name__ == "__main__":
	    print("ðŸ“¥ Loading reviews from S3...")
	    reviews = read_reviews_from_s3()
	
	    print(f"ðŸ§® Processing {len(reviews)} reviews for hashtags...")
	    with Pool(processes=cpu_count()) as pool:
|3,1,1,1,50,0,1750980590,"import boto3","import json","import re","from multiprocessing import Pool, cpu_count","from collections import Counter","","# S3 CONFIG","S3_BUCKET = 'imdbreviews-scalable'","S3_KEY = 'input_files/sample.json'  # Replace with correct path if needed","","# S3 Client","s3 = boto3.client('s3')","","# Stopwords or meaningless tags","INVALID_HASHTAGS = {f\"#{i}\" for i in range(1, 21)} | {'#t', '#a'}","","def read_reviews_from_s3():",>60
|<"    response = s3.get_object(Bucket=S3_BUCKET, Key=S3_KEY)","    content = response['Body'].read().decode('utf-8')","    return json.loads(content)","","# Define stop tags set globally","stop_tags = {","    'the', 'and', 'you', 'but', 'was', 'are', 'for', 'have', 'not',","    'his', 'her', 'she', 'there', 'with', 'this', 'that', 'what',","    'in', 'on', 'out', 'at', 'by', 'all', 'spoiler', 'movie', 'film',",>85
|<"    'one', 'more', 'some', 'just', 'from', 'like', 'contains', 'commentessentially'","}","","def extract_hashtags(review):","    text = review.get(\"review_detail\", \"\") + \" \" + review.get(\"review_summary\", \"\")","","    # Find hashtags that are standalone and alphabetic, at least 4 characters","    raw_tags = re.findall(r'(?<!\\w)#([a-zA-Z]{4,})\\b', text)","","    filtered = [","        f\"#{tag.lower()}\" for tag in raw_tags","        if tag.lower() not in stop_tags","    ]",>21
|<"    return filtered","","def flatten(list_of_lists):","    return [item for sublist in list_of_lists for item in sublist]","","if __name__ == \"__main__\":","    print(\"ðŸ“¥ Loading reviews from S3...\")","    reviews = read_reviews_from_s3()","","    print(f\"ðŸ§® Processing {len(reviews)} reviews for hashtags...\")","    with Pool(processes=cpu_count()) as pool:"
"2	LINE	0
	    top_hashtags = Counter(all_hashtags).most_common(10)
|3,0,2,1,1,0,1750980525,"    top_hashtags = Counter(all_hashtags).most_common(10)"
"3	LINE	0
	    return filtered
|3,0,3,1,1,0,1750980468,"    return filtered"
"4	LINE	0
	    
|3,0,4,1,1,0,1750980468,"    "
"5	LINE	0
	        filtered.append(tag)
|3,0,5,1,1,0,1750980467,"        filtered.append(tag)"
"6	LINE	0
	            continue
|3,0,6,1,1,0,1750980466,"            continue"
"7	LINE	0
	        if tag_text in stop_tags:
|3,0,7,1,1,0,1750980466,"        if tag_text in stop_tags:"
"8	LINE	0
	            continue
|3,0,8,1,1,0,1750980465,"            continue"
"9	LINE	0
	        if not tag_text.isalpha():  # Only alphabetic hashtags
|3,0,9,1,1,0,1750980465,"        if not tag_text.isalpha():  # Only alphabetic hashtags"

# File marks:
'0  11  19  ~/.gitignore
|4,48,11,19,1751039508,"~/.gitignore"
'1  11  19  ~/.gitignore
|4,49,11,19,1751039487,"~/.gitignore"
'2  10  6  ~/.gitignore
|4,50,10,6,1751039460,"~/.gitignore"
'3  10  6  ~/.gitignore
|4,51,10,6,1751039460,"~/.gitignore"
'4  10  6  ~/.gitignore
|4,52,10,6,1751039460,"~/.gitignore"
'5  10  6  ~/.gitignore
|4,53,10,6,1751039460,"~/.gitignore"
'6  8  16  ~/.gitignore
|4,54,8,16,1751039426,"~/.gitignore"
'7  8  16  ~/.gitignore
|4,55,8,16,1751039426,"~/.gitignore"
'8  8  16  ~/.gitignore
|4,56,8,16,1751039426,"~/.gitignore"
'9  8  16  ~/.gitignore
|4,57,8,16,1751039426,"~/.gitignore"

# Jumplist (newest first):
-'  11  19  ~/.gitignore
|4,39,11,19,1751039508,"~/.gitignore"
-'  11  19  ~/.gitignore
|4,39,11,19,1751039487,"~/.gitignore"
-'  10  6  ~/.gitignore
|4,39,10,6,1751039477,"~/.gitignore"
-'  10  6  ~/.gitignore
|4,39,10,6,1751039477,"~/.gitignore"
-'  10  6  ~/.gitignore
|4,39,10,6,1751039460,"~/.gitignore"
-'  8  16  ~/.gitignore
|4,39,8,16,1751039447,"~/.gitignore"
-'  8  16  ~/.gitignore
|4,39,8,16,1751039447,"~/.gitignore"
-'  8  16  ~/.gitignore
|4,39,8,16,1751039447,"~/.gitignore"
-'  8  16  ~/.gitignore
|4,39,8,16,1751039426,"~/.gitignore"
-'  7  4  ~/.gitignore
|4,39,7,4,1751039416,"~/.gitignore"
-'  7  4  ~/.gitignore
|4,39,7,4,1751039416,"~/.gitignore"
-'  7  4  ~/.gitignore
|4,39,7,4,1751039416,"~/.gitignore"
-'  7  4  ~/.gitignore
|4,39,7,4,1751039416,"~/.gitignore"
-'  7  4  ~/.gitignore
|4,39,7,4,1751039407,"~/.gitignore"
-'  6  10  ~/.gitignore
|4,39,6,10,1751039402,"~/.gitignore"
-'  6  10  ~/.gitignore
|4,39,6,10,1751039402,"~/.gitignore"
-'  6  10  ~/.gitignore
|4,39,6,10,1751039402,"~/.gitignore"
-'  6  10  ~/.gitignore
|4,39,6,10,1751039402,"~/.gitignore"
-'  6  10  ~/.gitignore
|4,39,6,10,1751039402,"~/.gitignore"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  42  28  ~/mapreduce_sentiment.py
|4,39,42,28,1751038661,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  14  22  ~/mapreduce_sentiment.py
|4,39,14,22,1751038643,"~/mapreduce_sentiment.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"
-'  54  30  ~/mapreduce_wordcount.py
|4,39,54,30,1751038640,"~/mapreduce_wordcount.py"

# History of marks within files (newest to oldest):

> ~/.gitignore
	*	1751039499	0
	"	11	19
	^	11	20
	.	11	19
	+	6	41
	+	4	0
	+	7	4
	+	4	0
	+	6	11
	+	8	17
	+	10	7
	+	11	19

> ~/mapreduce_sentiment.py
	*	1751038659	0
	"	42	28
	^	42	29
	.	14	29
	+	1	12
	+	1	11
	+	41	82
	+	14	21
	+	37	0
	+	36	22
	+	43	0
	+	6	10
	+	41	14
	+	42	14
	+	14	29

> ~/mapreduce_wordcount.py
	*	1751038638	0
	"	54	30
	^	54	31
	.	39	31
	+	1	12
	+	52	33
	+	54	71
	+	40	22
	+	54	0
	+	5	11
	+	54	12
	+	39	31

> ~/mapreduce_hashtag.py
	*	1751038603	0
	"	59	0
	^	59	14
	.	59	14
	+	1	12
	+	1	11
	+	1	12
	+	1	32
	+	1	21
	+	1	0
	+	1	29
	+	1	19
	+	1	9
	+	1	19
	+	1	0
	+	1	18
	+	1	13
	+	1	18
	+	1	96
	+	1	0
	+	1	12
	+	57	32
	+	10	21
	+	33	59
	+	32	4
	+	59	73
	+	40	22
	+	6	11
	+	10	22
	+	22	11
	+	42	12
	+	55	13
	+	59	14

> ~/imdb_summary.py
	*	1750977135	0
	"	90	0
	^	90	0
	.	89	23
	+	1	23
	+	1	67
	+	1	66
	+	1	0
	+	1	49
	+	1	67
	+	1	0
	+	1	92
	+	1	12
	+	89	23

> ~/imdb_consumer_kafka.py
	*	1750976759	0
	"	160	17
	^	179	0
	.	178	10
	+	1	9
	+	1	10
	+	1	0
	+	1	9
	+	1	10
	+	1	20
	+	1	9
	+	1	10
	+	1	15
	+	1	34
	+	1	38
	+	1	14
	+	1	38
	+	1	64
	+	1	23
	+	1	50
	+	1	9
	+	178	10

> ~/imdb_producer_s3.py
	*	1750968705	0
	"	1	0
	^	67	0
	.	66	83
	+	66	83
